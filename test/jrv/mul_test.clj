(ns jrv.mul-test
  (:refer-clojure :rename {and cj-and, or cj-or, not cj-not, rem cj-rem})
  (:require [clojure.test :refer :all]
   [jrv.korr [cj-utils :refer :all]
             [env :refer :all]
             [reg :refer :all]
             [fmt :refer :all]]
   [jrv.ins.mul32 :refer :all]
   [jrv.core-test :refer :all]
   )
  )


(deftest m-mul
  (is (jrv-v= (mul x0 x0 x0   ) 2r00000010000000000000000000110011))
  (is (jrv-v= (mul x31 x0 x0  ) 2r00000010000000000000111110110011))
  (is (jrv-v= (mul x0 x31 x0  ) 2r00000010000011111000000000110011))
  (is (jrv-v= (mul x31 x31 x0 ) 2r00000010000011111000111110110011))
  (is (jrv-v= (mul x0 x0 x31  ) 2r00000011111100000000000000110011))
  (is (jrv-v= (mul x31 x0 x31 ) 2r00000011111100000000111110110011))
  (is (jrv-v= (mul x0 x31 x31 ) 2r00000011111111111000000000110011))
  (is (jrv-v= (mul x31 x31 x31) 2r00000011111111111000111110110011)))


(deftest m-mulh
  (is (jrv-v= (mulh x0 x0 x0   ) 2r00000010000000000001000000110011))
  (is (jrv-v= (mulh x31 x0 x0  ) 2r00000010000000000001111110110011))
  (is (jrv-v= (mulh x0 x31 x0  ) 2r00000010000011111001000000110011))
  (is (jrv-v= (mulh x31 x31 x0 ) 2r00000010000011111001111110110011))
  (is (jrv-v= (mulh x0 x0 x31  ) 2r00000011111100000001000000110011))
  (is (jrv-v= (mulh x31 x0 x31 ) 2r00000011111100000001111110110011))
  (is (jrv-v= (mulh x0 x31 x31 ) 2r00000011111111111001000000110011))
  (is (jrv-v= (mulh x31 x31 x31) 2r00000011111111111001111110110011)))


(deftest m-mulhsu
  (is (jrv-v= (mulhsu x0 x0 x0   ) 2r00000010000000000010000000110011))
  (is (jrv-v= (mulhsu x31 x0 x0  ) 2r00000010000000000010111110110011))
  (is (jrv-v= (mulhsu x0 x31 x0  ) 2r00000010000011111010000000110011))
  (is (jrv-v= (mulhsu x31 x31 x0 ) 2r00000010000011111010111110110011))
  (is (jrv-v= (mulhsu x0 x0 x31  ) 2r00000011111100000010000000110011))
  (is (jrv-v= (mulhsu x31 x0 x31 ) 2r00000011111100000010111110110011))
  (is (jrv-v= (mulhsu x0 x31 x31 ) 2r00000011111111111010000000110011))
  (is (jrv-v= (mulhsu x31 x31 x31) 2r00000011111111111010111110110011)))


(deftest m-mulhu
  (is (jrv-v= (mulhu x0 x0 x0   ) 2r00000010000000000011000000110011))
  (is (jrv-v= (mulhu x31 x0 x0  ) 2r00000010000000000011111110110011))
  (is (jrv-v= (mulhu x0 x31 x0  ) 2r00000010000011111011000000110011))
  (is (jrv-v= (mulhu x31 x31 x0 ) 2r00000010000011111011111110110011))
  (is (jrv-v= (mulhu x0 x0 x31  ) 2r00000011111100000011000000110011))
  (is (jrv-v= (mulhu x31 x0 x31 ) 2r00000011111100000011111110110011))
  (is (jrv-v= (mulhu x0 x31 x31 ) 2r00000011111111111011000000110011))
  (is (jrv-v= (mulhu x31 x31 x31) 2r00000011111111111011111110110011)))


(deftest m-div
  (is (jrv-v= (div x0 x0 x0   ) 2r00000010000000000100000000110011))
  (is (jrv-v= (div x31 x0 x0  ) 2r00000010000000000100111110110011))
  (is (jrv-v= (div x0 x31 x0  ) 2r00000010000011111100000000110011))
  (is (jrv-v= (div x31 x31 x0 ) 2r00000010000011111100111110110011))
  (is (jrv-v= (div x0 x0 x31  ) 2r00000011111100000100000000110011))
  (is (jrv-v= (div x31 x0 x31 ) 2r00000011111100000100111110110011))
  (is (jrv-v= (div x0 x31 x31 ) 2r00000011111111111100000000110011))
  (is (jrv-v= (div x31 x31 x31) 2r00000011111111111100111110110011)))


(deftest m-divu
  (is (jrv-v= (divu x0 x0 x0   ) 2r00000010000000000101000000110011))
  (is (jrv-v= (divu x31 x0 x0  ) 2r00000010000000000101111110110011))
  (is (jrv-v= (divu x0 x31 x0  ) 2r00000010000011111101000000110011))
  (is (jrv-v= (divu x31 x31 x0 ) 2r00000010000011111101111110110011))
  (is (jrv-v= (divu x0 x0 x31  ) 2r00000011111100000101000000110011))
  (is (jrv-v= (divu x31 x0 x31 ) 2r00000011111100000101111110110011))
  (is (jrv-v= (divu x0 x31 x31 ) 2r00000011111111111101000000110011))
  (is (jrv-v= (divu x31 x31 x31) 2r00000011111111111101111110110011)))


(deftest m-rem
  (is (jrv-v= (rem x0 x0 x0   ) 2r00000010000000000110000000110011))
  (is (jrv-v= (rem x31 x0 x0  ) 2r00000010000000000110111110110011))
  (is (jrv-v= (rem x0 x31 x0  ) 2r00000010000011111110000000110011))
  (is (jrv-v= (rem x31 x31 x0 ) 2r00000010000011111110111110110011))
  (is (jrv-v= (rem x0 x0 x31  ) 2r00000011111100000110000000110011))
  (is (jrv-v= (rem x31 x0 x31 ) 2r00000011111100000110111110110011))
  (is (jrv-v= (rem x0 x31 x31 ) 2r00000011111111111110000000110011))
  (is (jrv-v= (rem x31 x31 x31) 2r00000011111111111110111110110011)))


(deftest m-remu
  (is (jrv-v= (remu x0 x0 x0   ) 2r00000010000000000111000000110011))
  (is (jrv-v= (remu x31 x0 x0  ) 2r00000010000000000111111110110011))
  (is (jrv-v= (remu x0 x31 x0  ) 2r00000010000011111111000000110011))
  (is (jrv-v= (remu x31 x31 x0 ) 2r00000010000011111111111110110011))
  (is (jrv-v= (remu x0 x0 x31  ) 2r00000011111100000111000000110011))
  (is (jrv-v= (remu x31 x0 x31 ) 2r00000011111100000111111110110011))
  (is (jrv-v= (remu x0 x31 x31 ) 2r00000011111111111111000000110011))
  (is (jrv-v= (remu x31 x31 x31) 2r00000011111111111111111110110011)))
